prefix: rx
from_obj: 'clean.prescribing'
knowledge_date_column: rx_order_date
intervals: ['1month','3month', '6month', '12month','all']

aggregates_imputation:
  all:
    type: 'zero'

aggregates:
  - # of prescribed medications
    quantity:
      total: '*'
    
    metrics: ['count']

  - # Number of unique rxnorms
    quantity:
      rxnorm: distinct rxnorm_cui
    
    metrics: ['count']

  - # Number of Statins
    quantity:
      statin: "
        case when rxnorm_cui in (
          '1897', '791834', '791846', '791838', '791842', '1659161', 
          '1659167', '1659179', '1659183', '6472', '997004', '997006', '997007', '884383', 
          '6574', '904661', '904665', '42463', '904669', '617314', '617318', '617320', '262095',
           '7393', '2282414', '2283236', '153302', '261244', '859749', '859753', '859421', '859426', 
           '1665900', '1665906', '1801322', '103918', '103919', '687048', '861646', '861650', '861654', 
           '1364490', '1364498', '209013', '206257', '206258', '1233888', '1233878', '1233883', '1233871', 
           '1367848', '757736', '763228', '999939', '763232', '999946', '757748', '763236', '2001260', 
           '2001264', '2001268', '904460', '904469', '904477', '904483', '2167563', '2167567', '2167571', 
           '2167575', '36567', '104490', '104491', '1944262', '152923', '1944266', '208220', '213319', 
           '83366', '153165', '617312', '83367', '617310', '617311', '259255', '215567', '309123', '596723', 
           '221072', '309124', '313936', '309125', '153303', '284424', '41127', '151972', '310404', '72875', 
           '310405', '360507', '284764', '433848', '541841', '352420', '224938', '433849', '1233869', '359731', 
           '1233870', '359732', '197903', '197904', '197905', '861634', '861640', '861648', '861612', '861652', 
           '861643', '2001255', '2001266', '2001252', '2001254', '2001262', '1944734', '203144', '203333', '904458', 
           '904467', '904475', '904481', '301542', '320864', '323828', '859747', '859751', '859419', '859424', '2167558', 
           '2167573', '2167557', '2167565', '2167569', '1944257', '1944264', '1790679', '196503', '198211', '200345', 
           '312962', '314231', '312961', '1312410', '1312417', '1312424', '593411', '621590', '1312423', '1312429', 
           '1372754', '1189803', '1312409', '1189805', '1189809', '1189822', '1312415', '1
          )
          then 1 
          else 0
          end 
      "
  metrics: ['sum']

- # High intensity statins
  quantity:
    histatin: "
      case when rxnorm_cui in (
        '83366', '83367', '153165', '617311', '617320', '259255', '262095', '301542', '320864', '323828', 
        '859751', '859753', '859419', '859421', '2167558', '2167565', '2167567', '2167569', '2167571', 
        '1422085', '341248', '1422087', '1422096', '1422098', '1422099', '1422101', '2535745', '2535748', 
        '2536055', '2536062', '2535749', '2536064', '17767', '104416', '404773', '404914', '597984', '750235', 
        '404011', '750239', '597990', '750207', '876514', '404013', '750211', '597993', '750215'
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']

- # obesity meds
  quantity:
    histatin: "
      case when rxnorm_cui in (
        '552890379','55289037930','578440140','57844014001','57844014056','727890175','72789017530','54569171800','57844000900','57844000901',
        '57844000956','57844001901','10702000103','10702000106','10702000109','10702000110','10702000125','10702000150','107020001',
        '636297874','63629787401','13107010501','13107010530','13107010601','13107010630','500903282','50090328200','50090328202','50090328204',
        '50090328205','131070105','131070106','516550872','51655087221','61919024430','61919031630','619190865','61919086530','61919086590',
        '001850644','001850647','001855000','005270597','005271308','005271310','005271438','005271445','00185064401','00185064410','00185064701',
        '005271742','00185500001','00185500010','005271743','00527059701','00527059710','00527130801','00527130810','00527131001','00527131010',
        '00527143801','00527143810','00527144501','00527144510','00527144530','00527174201','00527174210','00527174301','00527174310','10702002501',
        '10702002503','10702002510','10702002601','10702002603','10702002610','10702002701','10702002703','10702002710','107020025','10702002801',
        '10702002803','10702002810','107020026','10702002901','10702002903','10702002910','107020027','10702006703','10702006705','10702006710',
        '107020028','11534015701','11534015703','11534015901','107020029','11534015903','11534015930','11534016001','107020067','11534016003',
        '11534016030','11534017601','115340157','11534017603','12634051600','115340159','12634051601','12634051609','12634051640','115340160',
        '12634051642','12634051645','12634051650','115340176','12634051652','12634051654','126340516','12634051657','12634051658','12634051659',
        '12634051660','12634051661','12634051663','12634051666','12634051667','12634051669','12634051671','12634051674','12634051678','12634051679',
        '12634051680','12634051681','12634051682','12634051684','12634051685','12634051690','12634051691','12634051692','12634051693','12634051694',
        '12634051695','12634051696','12634051697','12634051698','12634051699','12634054700','12634054701','12634054709','12634054740','12634054742',
        '12634054745','12634054750','12634054752','12634054754','126340547','12634054757','12634054758','12634054759','12634054760','12634054761',
        '12634054763','12634054766','12634054767','12634054769','12634054771','12634054774','12634054778','12634054779','12634054780','12634054781',
        '12634054782','12634054784','12634054785','12634054790','12634054791','12634054792','12634054793','12634054794','12634054795','12634054796',
        '12634054797','12634054798','12634054799','12634058500','12634058501','12634058509','12634058540','12634058542','12634058545','12634058550',
        '12634058552','12634058554','126340585','12634058557','12634058558','12634058559','12634058560','12634058561','12634058563','12634058566',
        '12634058567','12634058569','12634058571','12634058574','12634058578','12634058579','12634058580','12634058581','12634058582','12634058584',
        '12634058585','12634058590','12634058591','12634058592','12634058593','12634058594','12634058595','12634058596','12634058597','12634058598',
        '12634058599','12634062900','12634062901','12634062909','12634062940','12634062942','12634062945','12634062950','12634062952','12634062954',
        '126340629','12634062957','12634062958','12634062959','12634062960','12634062961','12634062963','12634062966','12634062967','12634062969',
        '12634062971','12634062974','12634062978','12634062979','12634062980','12634062981','12634062982','12634062984','12634062985','12634062990',
        '12634062991','12634062992','12634062993','12634062994','12634062995','12634062996','12634062997','12634062998','12634062999','12634066500',
        '12634066501','12634066509','12634066540','12634066542','12634066545','12634066550','12634066552','12634066554','126340665','12634066557',
        '12634066558','12634066559','12634066560','12634066561','12634066563','12634066566','12634066567','12634066569','12634066571','12634066574',
        '12634066578','12634066579','12634066580','12634066581','12634066582','12634066584','12634066585','12634066590','12634066591','12634066592',
        '12634066593','12634066594','12634066595','12634066596','12634066597','12634066598','12634066599','12634071100','12634071101','12634071109',
        '12634071140','12634071142','12634071145','12634071150','12634071152
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']


- # Bile acid
  quantity:
    histatin: "
      case when rxnorm_cui in (
        '202582','2447','10159','848943','848949','848946','848951','218059','1311524','93918','219397','1801279','1801280','218060','284918','866910',
        '866912','141625','141626','866905','866907','1048450','1048452','2685','104485','151533','1048445','1048447','1009044','1801272','1801268',
        '317329','1801265','1156140','1801273','1801269','1801266','1801274','1177645','1801270','1185876','866900','1870344','1870340','1870336',
        '866911','866909','1870337','1164984','368175','374632','1164985','1870341','1870338','1870342','1187941','1187942','1296445','1166289',
        '1166290','1295303','2100172','2100170','1048446','1048444','1048451','1048449','1155486','368090','374415','1155487'
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']


- # anti depressant
  quantity:
    antidep: "
      case when rxnorm_cui in (
        '1439803','1439808','1439824','1439834','1439844','1455099','1439803','1439810','1439824',
        '1439834','1439838','1455099','1439803','1439812','1439824','1439829','1439834','1455099',
        '2556','200371','213344','215928','221078','2556','213345','215928','221078','309314',
        '2556','108886','151516','200371','213344','215928','221078','540845','540848','2556',
        '151516','213345','215928','221078','226376','309314','540845','321988','351250','352273',
        '352741','353108','4493','4493','58827','104849','227224','227224','284849','310385','352940',
        '352940','639464','647442','799023','799023','799059','4493','58827','227224','248642','284849',
        '352004','352940','352940','639464','647556','799023','799023','4493','58827','104850','227224',
        '284849','310386','352940','352940','639464','799023','799023','4493','227224','4493','58827',
        '227224','261287','284849','313989','352940','352940','639464','799023','799023','4493','58827',
        '227224','284849','352940','352940','639464','799023','799023','1190110','42355','42687','203143',
        '903884','903885','42355','42687','203143','903887','903889','42355','42687','203143','903891',
        '903893','42355','42687','203143','903873','903875','42355','42687','203143','903879','903881',
        '321988','349332','352272','352741','353108','321988','351250','352273','352741','353108','42355',
        '42687','203143','903884','42355','42687','203143','903873','903875','42355','42687','203143',
        '903879','903881','4493','61381','227224','403971','405343','611247','725068','32937','114228',
        '196471','207349','235830','314199','541662','1430123','1738495','32937','114228','196471','207350',
        '235830','312243','541664','1430123','1738503','32937','114228','196471','211700','235830','312244',
        '541666','1430123','1738511','32937','32937','114228','114228','196471','196471','235830','235830',
        '562791','828448','1430123','1430123','1738805','1738806','32937','32937','114228','114228','196471',
        '196471','235830','235830','562815','828451','1430123','1430123','1738807','1738808','32937','196471',
        '207349','314199','436212','541657','541662','1430123','1738519','32937','196471','207350','312243','
        436212','541657','541664','1430123','1738523','32937','196471','211700','312244','436212','541657',
        '541666','1430123','1738527','32937','114228','207349','235830','314199','1738495','32937','114228',
        '207350','235830','312243','1738503','32937','114228','211700','235830','312244','1738511','32937',
        '32937','114228','235830','235830','261604','562791','828448','1738805','1738806','32937','32937',
        '114228','235830','235830','261604','562815','828451','1738807','1738808','32937','314199','436212',
        '541657','541662','1738519','32937','312243','436212','541657','541664','1738523','32937','312244',
        '436212','541657','541666','1738527','4493','58827','227224','4493','58827','104849','227224','310385',
        '4493','58827','104850','227224','310386','4493','58827','227224','4493','58827','227224','261287',
        '313989','4493','58827','227224','284849','313995','598032','4493','227224','248642','352004','352940',
        '4493','227224','310385','639464','647442','4493','227224','248642','639464','647556','4493','227224',
        '310385','799023','799059','36437','82728','155137','208149','312938','36437','82728','155137','208161',
        '312941','258326','258326','284046','200144','258326','200145','258326','258326','252714','258326','258326',
        '259197','242715','258326','252718','258326','4493','61381','227224','403971','405343','611247','725061',
        '725065','725068','725069','725073','725077','4493','61381','227224','405343','611247','721787','725061',
        '725065','725069','725073','725077','725080','4493','61381','227224','403969','405343','611247','725061',
        '725064','725065','725069','725073','725077','4493','61381','227224','403972','405343','611247','725061',
        '725065','725069','725072','725073','725077','1439803','1439808','1439834','1455099','1790881','1790886',
        '1439803','1439810','1439834','1455099','1790881','1790890','1439803','1439812','1439834','1455099',
        '1790881','1790892','1086768','1086769','1086773','1086784','1086786','1086768','1086769','1086773',
        '1086789','1086790','1086768','1086769','1086773','1086784','1086786','1439803','1439808','1439824',
        '1439834','1439844','1455099','1790881','1790886','1439803','1439810','1439824','1439834','1439838',
        '1455099','1790881','1790890','1439803','1439812','1439824','1439829','1439834','1455099','1790881',
        '1790892','36437','82728','155137','208149','312938','36437','82728','155137','208161','312941',
        '72625','476250','482574','596934','615186','734064','790264','790267','1435475','1435475','1435480',
        '734064','790264','790267','1435475','1435475','1435480','734064','790288','790290','1435475','1435475',
        '1435483','734064','790288','790290','1435475','1435475','1435483','734064','790264','790267','1435475',
        '1435480','734064','1435475','734064','790288','790290','1435475','1435483','734064','1435475','683693',
        '711372','734064','790264','790267','1435475','1435480','1874553','1435475','1435483','1874559','72625','
        476250','482574','596934','615186','1652064','2200169','72625','476250','482574','596934','615186','1652064',
        '2200169','2200181','2200183','39786','151692','153570','235988','313581','729931','1433211','1433212','1433217',
        '1433218','1433223','1433211','1433212','1433218','1433249','1433250','1433211','1433212','1433218','1433227',
        '1433229','1433211','1433212','1433218','1433233','1433235','1433211','1433212','1433218','1433239','1433241',
        '734064','790264','1435475','1435480','734064','790288','1435475','1435483','1433211','1433212','1433218','1433218',
        '1433249','1433250','1433211','1433212','1433217','1433218','1433218','1433223','1433211','1433212','1433218','1433218',
        '1433227','1433229','1433211','1433212','1433218','1433218','1433233','1433235','1433211','1433212','1433218','1433218',
        '1433239','1433241','30003','588250','833135','833136','833139','30003','588250','833136','833147','833149','30003',
        '588250','833136','833144','833146','683693','711372','734064','790264','790267','1874553','683693','711372','734064',
        '790288','790290','1874559','30003','588250','833135','833136','833139','39786','151692','235988','313581','729931',
        '39786','151692','235988','808744','39786','151692','235988','808748','410503','94','1424836','852136','852139','258326',
        '252718','1442341','220736','201692','856785','856861','856764','856766','151658','856775','856777','201694','856838',
        '201696','856847','856849','856855','856857','214220','205696','197364','205703','205706','205709','722','197363','203531',
        '197365','197366','198045','7531','135820','203130','312036','317136','993520','993559','581650','835486','993548','993550',
        '993552','993567','993569','993681','993683','581646','1232586','993505','993524','993542','1232585','1232591','283672',
        '284591','309313','261342','2556','200371','213344','215928','221078','213345','309314','151516','153503','540845','108886',
        '540848','226376','756','2597','81984','857297','857299','857301','857303','857305','857307','72625','476250','482574',
        '596926','596928','596930','596932','596934','615186','1099288','1099290','8078','1099300','1099302','1099398','1099304',
        '1099306','1874553','790264','1435475','1435480','1607617','1607619','1435483','10737','82112','204192','856369','1000050',
        '1000052','9801','224914','261625','966788','1000056','1000060','1000062','1000066','1000068','1000072','1000074','966787',
        '966791','1000078','1000081','966793','966795','1000099','1000101','2200175','2200177','2200178','2200180','2200181','2200183',
        '1652064','2200169','2200168','2200174','616402','1652069','313580','208848','39786','151692','235988','313582','208849','313584',
        '208850','314277','208851','313586','208853','313581','729931','313583','729932','313585','729929','153570','856812','856859','856762',
        '856773','856834','856836','42940','856853','859186','859188','865214','865216','617716','865206','865208','865210','865212','227456',
        '856783','856706','704','8076','203168','856797','1012360','856825','647325','799026','261282','313990','352940','639464','647555',
        '799023','803293','803295','647442','799059','248642','352004','647556','1190110','351962','903885','903889','903893','903873','903875',
        '903879','903881','90','4301','4511','144450','849445','259393','319812','259855','102550','353556','102551','1433249','1433250','1433217',
        '1433223','1433211','1433212','1433218','1433227','1433229','1433233','1433235','1433239','1433241','349332','352272','351250','352273',
        '321988','351249','352741','353108','404408','351285','404420','2356','28727','856769','974990','856778','856781','856792','218020',
        '856793','856796','10898','1298857','6482','6646','203126','1298861','1298870','903884','42355','42687','203143','903887','903891',
        '1298859','1298863','1298872','6011','104837','152005','201708','6711','1094141','1094326','1094329','1094140','833135','833139',
        '833150','833151','30003','588250','833136','833141','833143','833147','833149','833144','833146','476809','7243','105069','1551467','1551468',
        '1551469','1551474','8123','8124','104836','203799','312347','485514','1099292','1099294','1099296','1099298','3247','203174','203771','1099316','1099318','209329','1100363','583236','1100366','209339','583239','1100384','198046','209350','721787','725080','7866','209464','198047','209391','10734','91119','104838','203832','313447','196471','1430123','1430122','1430128','211699','1738483','312241','213291','312242','207349','1738495','314199','207350','1738503','312243','32937','114228','211700','235830','1738511','312244','1738803','1738804','261604','562790','828446','1738805','1738806','562791','828448','1738807','1738808','562815','828451','856708','856710','856717','856799','856806','856810','856720','856722','856755','856760','856829','856833','220447','856840','856844','1372684','1372742','217000','217001','282427','352606','352607','352608','856714','856752','856757','856807','856826','856830','856841','436212','541657','541660','1738515','541662','1738519','541664','1738523','541666','1738527','790267','683693','711372','734064','790290','1874559','790288','141946','141945','151543','205535','310384','104849','310385','4493','58827','227224','310386','104850','261287','313989','313995','284849','598032','1000093','15996','134774','211322','311725','211323','314111','261135','311726','283406','752869','283407','752870','283485','752871','284857','9639','47695','92571','151256','151281','152629','152723','152746','203137','225844','352446','643054','859193','859195','859200','865217','880384','897065','1098649','1098651','1098666','1098668','1098670','1098672','1098674','1098676','31565','151679','236082','1098678','1098680','1000048','3638','203179','224915','1000054','1000058','1000064','1000070','1000076','1000097','284046','200144','242637','200145','252714','259197','242715','6574','6582','236665','259823','289497','208645','313496','10834','71532','208646','225029','313498','106834','313499','403970','725076','403971','725068','61381','403969','405343','611247','725064','725061','725065','725069','725073','725077','403972','725072','5691','6716','150816','835593','835596','835564','835566','835568','835570','835591','835598','835589','835600','835577','835579','91118','220334','835572','835574','856373','856375','104824','856364','856366','856371','281674','856377','856379','898698','898697','898701','898704','898706','152158','199906','386230','386232','580312','580315','102560','200972','200973','313525','856845','856851','808744','808748','808751','808753','1653469','1653470','1086789','1086790','1086768','1086769','1086772','1086773','1086776','1086778','1086780','1086784','1086786','905168','905170','8886','11270','203199','905172','905174','1439808','1439844','1790886','1439810','1439838','1790890','1439812','1439824','1439829','1439834','1455099','1790881','1790892','1439803','993687','993688','993691','993693','993503','993511','42347','42568','203204','993518','993528','220936','993536','993537','993541','993545','405400','993557','993564','859190','859192','208149','312938','861064','861066','212233','312940','36437','82728','155137','208161','312941','1000091','1000095','227948','993954','1801289','6129','6130','203184','206967','238082','206972','238084','206970','238083','1368270','631198','631201','631202','631205','631279','631282','1050095','1050098','1087923','1087926','1301255','1301259','1368274','1426153','1426157','1486680','1486837','1605769','1605773','1361661','1150109','1292462','2119365','2119366','2119381','2119382','2119387','2119390','2119391','2119388','2119389','6960','26225','203148','1815','28200','35827','267396','35780','236539  
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']


- # nadolol
  quantity:
    nadolol: "
      case when rxnorm_cui in (
        7226','151549','198006','206961','198007','201337','198008','201338','198004','206964','198005',
        '206968','1369','104324','198001','208029','214288','1372687','1372756','360525','198000','208003
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']


- # propranolol
  quantity:
    propranolol: "
      case when rxnorm_cui in (
        '8787','82084','151355','151367','151426','151492','151890','152258','381209','541545','856468','856737',
        '1495059','151415','152259','856739','856443','856445','856556','856557','104293','200840','200841',
        '200842','200843','200844','856448','856450','856457','856459','856508','104294','200829','200830',
        '200831','200832','200833','856519','856521','856528','104295','200846','200847','200848','200849',
        '200850','856578','856579','5487','27505','214623','856422','856426','856423','856430','856583',
        '856588','856593','856429','856433','856724','856733','856535','856537','856569','856571','856576',
        '856460','856462','856471','856481','856483','856417','856597','856393','856587','856406','856592','1495058','1495064
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']


- # carvedilo
  quantity:
    carvedilo : "
      case when rxnorm_cui in (
        '20352','108356','151723','200032','212389','216221','108357','200033','212390','200031','212388','226856',
        '226855','686924','686926','668310','860510','860512','860516','860518','860522','860524','860532','860534
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']


- # Antihypertensive
  quantity:
    hypterten: "
      case when rxnorm_cui in (
        '1008897','1009213','1009213','1009213','1009213','1009213','1009213','1009216','1009216','1009216','1013931',
        '1013931','1013931','1013931','1013931','102317','102318','103945','104375','104375','104376','104376','104377',
        '104377','104378','104378','104382','104384','104384','104385','104385','104463','104463','104463','104463',
        '104463','104463','104463','104463','1050312','1050312','1050312','1050312','1050312','1050312','1050312',
        '1050312','1050312','1050312','1050312','1050312','1050312','1050315','1050315','1050338','1050338','106680','106681',
        '106682','1087322','1087322','1091642','1091642','1091642','1091642','1091643','1091643','1091643','1091643','1091646',
        '1091646','1091647','1091647','1091647','1091647','1091650','1091650','1091652','1091652','1091654','1091654','114221',
        '114221','114221','114221','114221','114221','118463','118463','118463','118463','118463','118463','1298874','1298874',
        '1298874','1298876','1298876','1299896','1299896','1299897','1299897','1299963','1299963','1299965','1299965','1302755',
        '1302755','1302755','135481','135481','135481','135481','135481','135481','135481','135481','1369','1369','1369','1369',
        '1369','1372711','1372711','1372718','1372718','1372720','1372720','1372735','1372735','1372735','1372735','1372735',
        '1373003','1373003','1373008','1373008','142432','142432','142432','142432','142432','142432','142432','142432','142432',
        '142432','142432','142432','142432','142432','142432','142432','142432','142432','142432','142432','142432','142432',
        '142432','142432','142432','142432','142432','1435624','1435624','1435624','1435624','1435625','1435625','1435625',
        '1435625','1435625','1435625','1435625','1435625','1435630','1435630','1435630','1435630','1485753','1485753','1485753',
        '1485753','1485753','1485753','1485753','1485753','1485753','1485753','1485753','1485753','1485753','1485753','1485753',
        '1485753','1485753','1485753','1485753','1485753','1485753','1485753','1485753','1485753','1485753','1488665','1488665',
        '1488667','1488667','1488670','1488670','1488671','1488671','1488674','1488674','1488675','1488675','1488678','1488678',
        '1488679','1488679','151292','151292','151292','151292','151294','151294','151294','151294','151318','151318','151318',
        '151318','151318','151318','151318','151318','151482','151482','151482','151482','151482','151482','151482','151482',
        '151486','151486','151486','151486','151486','151486','151486','151558','151558','151558','151558','151558','151558',
        '151594','151594','151904','151904','151904','151904','151904','151904','153079','153079','153080','153080','153275',
        '153276','153277','153278','153278','153278','153278','153311','153312','153313','153314','153314','153314','153314',
        '153460','153461','153462','153463','153463','153463','153463','153665','153665','153666','153666','153667','153667',
        '153668','153668','153668','153668','153668','153668','153822','153822','153823','153823','154991','154991','154991',
        '154991','154991','154991','155091','155091','1593603','1593603','166179','166179','1729002','1729002','1729002','
        1729002','1729002','1729002','1729002','1729002','1729002','1729002','1729002','1729002','1729002','1729002','1729002',
        '1729002','1729002','1729002','1729002','1729002','1729007','1729007','1729008','1729008','1729008','1729008','1729008',
        '1729008','1729008','1729008','1729008','1729008','1729008','1729008','1729008','1729008','1729008','1729008','1729008',
        '1729008','1729008','1729008','1729013','1729013','1729027','1729027','1729029','1729029','1729031','1729031','1729033',
        '1729033','1729045','1729045','1729047','1729047','1729051','1729051','1729053','1729053','1729055','1729055','1729057',
        '1729057','1729059','1729059','1729061','1729061','1729063','1729063','1729065','1729065','1729075','1729075','1729076',
        '1729076','1729200','1729200','1729201','1729201','1729205','1729205','1730925','1730925','1730927','1730927','1730928',
        '1730928','1730929','1730930','1730930','1730931','1730931','1806884','1806884','1806885','1806885','1806885','1806885',
        '1806885','1806885','1806885','1806885','1806890','1806890','1858831','1858831','1858833','1858833','1876368','1876368',
        '1876369','1876369','1876369','1876369','1876369','1876369','1876369','1876373','1876373','18867','18867','18867','18867',
        '18867','18867','18867','18867','1927409','1927409','1927409','1927409','1927409','1927409','1927409','1927409','1927409',
        '1927409','1927409','1927409','1927409','1927409','1927409','1927409','196472','196472','196472','196472','196472','196472',
        '196472','196472','196472','196472','196472','196472','196472','196500','196500','196500','197477','197477','197477','197477',
        '197477','197477','197477','197562','197562','197562','197563','197563','197563','197564','197564','197743','197743','197744',
        '197744','197745','197745','197746','197746','197771','197771','197771','197771','197771','197771','197771','197771','197771',
        '197771','197771','197771','197771','197771','197771','197771','197771','197771','197771','197771','197771','197771','197789',
        '197789','197789','197789','197789','197789','197790','197790','197790','197790','197790','197790','197884','197884','197884',
        '197952','197952','197952','197952','197952','197952','197952','197953','197953','197953','197953','197953','197953','197954',
        '197954','197955','197955','197956','197956','197956','197958','197958','197958','197959','197959','197960','197960','197960',
        '197961','197961','197962','197962','197963','197963','197963','197980','197980','197986','197986','197986','197987','197987',
        '197987','198188','198188','198189','198189','198196','198196','198196','198196','198196','198197','198197','198197','198197',
        '198197','198197','198197','198197','198197','198197','198197','198197','198198','198198','199351','199351','199352','199352',
        '199353','199353','1996254','1998','1998','1998','1998','1998','1998','1998','1998','1998','1998','1998','199850','199850',
        '1999185','1999185','1999187','1999187','199919','199919','200094','200094','200095','200095','200096','200096','200222',
        '200222','201347','201348','201348','201350','201350','201354','201355','201358','201369','201370','201370','201371',
        '201372','201372','201373','201374','201374','201377','201378','201379','201380','201381','201382','201388','201388',
        '202262','202263','202463','202463','202463','202463','202463','202463','202463','202463','202463','202594','202594',
        '202595','202693','202693','202693','202706','202706','202706','202706','202941','202941','202941','202941','202941',
        '202941','202941','202941','202941','202941','202941','202941','202941','202941','202941','202941','202941','203123','203123','203123','203123',
        '203123','203123','203123','203123','203123','203123','203123','203123','203123','203142','203142','203142','203142','203151','203151','203160',
        '203160','203160','203160','203160','203160','203181','203181','203181','203181','203181','203181','203181','203181','203644','203644','203644','203644',
        '203644','203644','203644','203644','203644','203644','203644','203644','203673','203673','203673','203673','204404','204404','204404','204452','204452','204452','204474','204474','204501','204501','204501','204501','204501','204501','204501','204501','204501','204501','204501','204501','204501','2052423','2052423','2052424','2052424','205304','205304','205305','205305','205326','205326','205474','205476','205478','205480','205480','205482','205482','206387','206389','206397','206398','206403','206403','206412','206412','206413','206413','206558','206563','206763','206764','206764','206765','206765','206766','206766','206770','206770','206771','206771','207094','207640','207640','207678','207678','207678','207678','207891','207891','207892','207892','207893','207893','207895','207895','208065','208065','208066','208067','208084','208085','208086','208088','208089','208090','208091','208092','208093','208825','208825','210671','210671','210672','210672','210673','210673','210994','210994','211199','211199','211199','211200','211200','211200','2121076','2121076','213172','213172','213431','213431','213432','213432','213482','213482','213498','213504','213505','214354','214354','214354','214354','214354','214354','214354','214354','214418','214418','214418','214418','214418','214418','214418','214418','214418','214418','214418','214472','214472','21455','21455','21455','21455','21455','214615','214615','214615','214615','214615','214615','214616','214620','214620','214620','214620','214620','214620','214620','214620','214620','214620','214620','214624','214624','214788','215091','215092',
        '215458','215458','215458','215458','215458','215458','215458','215458','215917','215918','215919','216099','216099','216099','216099','216099','216099','216652','216652','216652','216652','216652','216652','216652','216652','216652','216652','216652','216652','216652','216676','216679','216679','216778','216778','216778','216778','216778','216909','216909','216909','216910','217159','217159','217594','217594','217594','217597','217597','217597','217597','217597','217597','217601','217601','217608','217608','217608','217639','217639','217640','217640','217642','217642','217642','217642','217643','217643','217643','217643','217653','217653','217653','217653','217749','217749','218088','218088','218088','218088','218088','218088','218088','218088','218198','218198','218198','218226','218226','218245','218245','218245','218245','218245','218245','218353','218353','218353','218353','218353','218353','218753','218753','218753','218753','218753','218753','219584','219584','219615','219615','219615','219729','219729','219734','219734','219797','219797','219797','219798','219798','219798','219878','219878','219878','219879','219879','219881','219881','219881','219882','219882','220391','220391','220391','220620','220620','220669','220669','220675','220675','220675','220675','224921','224921','224921','224921','224921','224921','224921','224921','224921','224921','224921','225030','225030','225030','225030','225030','225030','225191','225191','225191','225191','225702','225702','2264759','2264759','226700','226701','226702','226706','226707','226708','226709','226709','226709','226709','227225','227225','227225','227225','227278','227278','227278','227278','227278','227278','235758','235758','235758','235758','235758','235758','235758','235758','235759','235759','235759','235759','235759','235759','235759','235759','235759','235759','235759','235759','236066','236066','236066','236066','236878','236878','236878','236878','237192','237192','237192','237192','237192','237192','237192','237192','237192','237192','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','2396','240793','240793','240793','240793','240793','240793','2409','2409','2409','2409','2409','2409','2409','2409','2409','2409','2409','2409','2409','2409','2409','2409','2409','24853','24853','251856','251856','251857','251857','2565271','2565271','2565275','2565275','2584337','2584337','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2599','2602751','2602751','2602754','2602754','2602756','2602756','2602758','2602758','2602760','2602760','2602762','2602762','2602764','2602764','2602766','2602766','2602767','2602767','2602768','2602768','2602769','2602769','2602770','2602770','2602773','2602773','2602774','2602774','260333','260333','261300','261300','261301','261301','261438','261438','261438','261438','261438','261438','261962','261962','262242','262242','262242','262242','262418','262418','262418','262418','262418','262418','262418','262418','262418','262418','262418','262418','262418','262418','262418','262418','26296','26296','26296','26296','2630666','2630666','2630667','2630667','2630668','2630668','2630669','2630669','2630670','2630670','2630671','2630671','266604','266604','282755','282755','284213','284213','284531','284531','284747','284747','284747','285061','285061','285061','285061','285061','285061','285061','285061','287585','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29046','29155','29155','29155','29155','30131','30131','30131','30131','308962','308962','308963','308963','308964','308964','310139','310139','310140','310140','310662','310662','310663','310663','310664','310664','310665','310665','310665','310666','310666','310666','311353','311353','311353','311354','311354','311354','312748','312748','312749','312749','312750','312750','314076','314076','314076','314077','314077','314077','314203','314203','317173','317173','317836','317836','317836','317836','317836','321064','321064','321064','321064','321064','321064','323640','323640','323640','323640','323640','323640','323640','323640','327503','327503','327503','327503','327503','327503','3327','3327','342691','342691','342691','342691','342691','342691','342691','342691','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','343048','349199','349199','349200','349200','349201','349201','349373','349373','349401','349401','349405','349405','349407','349407','349408','349408','349409','349409','349410','349410','349483','349483','351761','351761','351762','351762','352001','352001','35208','35208','35208','35208','35208','35208','35208','35208','35208','35208','35208','35208','352199','352199','352200','352200','352201','352201','352211','352211','352212','352212','352213','352213','352214','352214','352274','352274','35296','35296','35296','35296','35296','35296','35296','35296','35296','35296','35296','35296','35296','35296','35296','35296','381009','381009','381009','381009','381009','381009','381009','381009','381009','381009','381009','381151','381151','381151','381151','3829','3829','3829','3829','3829','3829','3829','3829','3829','3829','3829','3829','3829','3829','3829','38454','38454','38454','38454','38454','38454','40114','40114','40114','40114','40138','40138','40138','40138','40138','40138','401965','401965','401968','401968','405139','405139','405139','405139','487056','487056','487056','487056','4919','4919','4919','4919','50166','50166','50166','50166','50166','50166','5033','5033','5033','5033','5034','5034','5034','5034','5036','5036','5036','5036','5036','5036','5036','5036','52175','52175','52175','52175','52175','52175','540784','540784','540784','540784','540787','540791','541019','541019','541019','541019','541022','54552','54552','54552','54552','54552','54552','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5470','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487','5487',
        '5487','5487','5487','5487','5487','5495','5495','5495','5495','5495','5495','5495','5495','5495','5495','5495','5495','5495','5495','5495','562344',
        '562344','562344','562344','562344','562501','562501','562501','562501','562502','562502','562502','562502','577776','577776','577785','577785','577787',
        '577787','582595','582595','582595','582595','582608','582608','591568','591568','591568','591568','591568','591568','597457','597457','6185','6185',
        '6185','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174','62174',
        '62174','62174','62174','639537','639537','639539','639539','639543','639543','6673','6673','6673','6860','6860','6860','6860','6860','6860','6860',
        '6860','6860','6860','6860','6860','6860','6860','6860','6876','6876','6876','6876','6876','6876','6876','6876','6876','6876','6876','6876','6876',
        '6876','6876','6876','6876','6876','6876','6876','6876','6876','6876','6876','6876','688640','688640','688640','688640','688640','688640','688640',
        '688640','688640','688643','688645','688647','688649','69749','69749','69749','69749','69749','69749','69749','69749','69749','69749','69749','69749',
        '69749','6984','6984','6984','6984','6984','6984','71556','71556','71556','71556','72210','72210','72210','72210','72210','72210','72210','72210',
        '72260','72260','72260','72260','72260','72260','730511','730511','730512','730512','730513','730513','730514','730514','73494','73494','73494',
        '73494','73494','73494','7442','7442','7442','7442','750192','750192','750192','750195','82027','82027','82027','82027','82027','82027','82027',
        '82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027',
        '82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027',
        '82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027',
        '82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027','82027',
        '82027','827690','827690','827693','827693','83515','83515','83515','83515','83818','83818','83818','83818','83818','83818','845488','845488',
        '845489','845489','854925','854925','854927','854927','854984','854984','854986','854986','854988','854988','854990','854990','8565','8565','8565','857169','857169','857171','857171','857183','857183','857185','857185','857187','857187','857189','857189','857795','857795','857795','857795','857795','857795','857795','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857796','857799','857799','857799','857799','857799','857799','857799','858804','858804','858806','858806','858810','858810','858812','858812','858813','858813','858815','858815','858817','858817','858819','858819','858845','861964','861964','861966','861966','862007','862007','8814','8814','8814','8814','8814','8814','8814','8814','884173','884173','884175','884175','884185','884185','884187','884187','884189','884189','884191','884191','884192','884192','884192','884192','884193','884193','884193','884196','884196','884198','884198','884198','884198','884199','884199','884199','884202','884202','884203','884203','884203','884204','884204','884204','884207','884207','884208','884208','884208','884211','884212','884212','884212','884215','884228','884228','884228','884231','885878','885878','885880','885880','898687','898687','898689','898689','898690','898690','898692','898692','898719','898719','898721','898721','898723','898723','898725','898725','905199','905199','905199','905201','905203','905203','905203','905203','905204','905204','905204','905204','905204','905204','905204','905204','905204','905207','905207','905211','905211','905211','905211','905211','905212','905212','905212','905212','905212','905212','905212','905212','905212','905215','905215','905217','905217','905217','905217','905217','905217','905218','905218','905218','905218','905218','905218','905218','905218','905218','905221','905221','905222','905222','905224','905225','905225','905225','905225','905225','905225','905227','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905353','905355','905367','905367','905395','905395','905395','905395','905395','905395','905397','905397','905399','905401','905403','905405','905405','905407','905409','905411','905411','905413','91239','91239','91239','91239','91240','91240','91240','91241','91241','91241','91825','91825','91825','91825','91825','91825','91825','91825','91825','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','9260','966571','966574','966574','966574','966574','966574','966574','966587','966591','966594','979480','979480','979482','979482','979485','979485','979487','979487','979492','979492','979494','979494','9895','9895','9895','9895','9895','9895','9895','9895','9895','9895','9895','9895','9895','9895','998588','998588','998671','998671','998673','998673','998675','998675','998677','998677','998679','998679','998681','998681','999724','999724
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']


- # Corticosteroids
  quantity:
    steroid: "
      case when rxnorm_cui in (
        105412','1303125','1303126','1303131','1303132','1303134','1303135','1303137','151587','198144','198145','198146','198148','201082',
        '201083','205301','206199','206754','206755','206837','206954','206955','206956','206957','206988','206989','206990','206997','206998','207048','207049','219350','220028','220029','224927','224928','224929','227730','259966','312615','312617','315187','351399','351400','351401','352903','380826','541812','541815','541872','582600',
        '582603','6902','763179','763181','763183','763185','795858','795860','795861','834395','845491','845492','845493','845494','8640',
        '82074','2400','39625','220893','7299','3498','9525','8091','2370134','2531274','318340','1114513','1293876','11423','1362','11002','1418','34347',
        '93869','5492','6972','220892','1427235','5509','235483','202643','202647','202652','217618','219147','1189202','203594','208930','215351','217628',
        '217744','218722','219595','219806','1664355','261703','702425','1310641','217624','603952','707790','2399645','8132','8536',
        '7300','27197','216247','405371','758861','1046685','6932','57555','163524','215353','216236','217619','219422','261618','1738592','202644','217827',
        '219814','1043071','1314860','214999','217589','405149','636026','797858','2462506','1294244','93609','217302','217629','763540','900406','1291','42790',
        '1116499','1441649','6387','9009','216234','8928','237099','1426447','3435','998422','998426','104129','202655','215840','216488','877491','884074',
        '1483219','1650984','351396','706544','82091','106258','1191043','1191375','402899','10753','142440','1094444','1116500','1246571','1114854','10223','853379','1094443','216929','221082','2588846','168','11256','352427','1012223','1012567','281','827346',
        '1442871','219121','1191376','1191394','20877','544035','753076','1012266','1012246','1043690','106955','1234512','1790684','202639','216490','219591','219813','1039920','2533903','216481','352926','151874','202641','219425',
        '405356','543489','759717','795064','808350','385343','1250490','310891','310879','35382','218814','759714','1291086','1809845','218759','310861','1234506','220926','351706','808112','1012327','6135','215068','215381','217625','606037','151363','215551','217363','1314928',
        '220264','900412','1987140','2399658','220238','1483214','352639','34552','49670','1094447','4780','1438748','1491718','1086947','106234','235482','216487','1291082','19476','689371','1293865','1442867','1790680','215069','866067','92264','1250486','1360949','830758','1440184',
        '203105','206316','5942','216255','310878','1291376','215264','103403','81981','206356','404044','707793','1739867','1865144','2533907','206355','206359','1193311','310868','94592','27199','215158','217951','541004','21651','27196','310900','215899','1250494','202654','1039270',
        '1294113','206354','217475','543492','827343','762583','1314864','202653','212078','285086','1294115','351349','202645','206282','225665','206370','543685','1043063','702428','605646','900500','215344','211598','219334','1234509','1234514','206314','206366','404045','1291380','1089742','284840','1012574','1012346','1293874',
        '106964','91263','2551','1012628','1294025','1012235','1542796','606794','103468','206340','797861','616256','1012233','1360956','218657','688307','1246576','604449','761646','206328','198707','1370748','92267','689623','1115727','1234338','1234322','216063','1429375','106987','220832','1359459','1250436','1441185','1039279','1291092','1293891',
        '198706','904783','105396','726766','260309','197783','238754','1037328','238755','206027','220397','206032','206034','217675','1235049','220030','206349','1291374','1674193','309349','244492','206362','260307','1664359','1293729','690691','106248','212220','1545174','214969','544125','1539198','213526','1012324','206026','206368','310869','103399',
        '206367','1050231','1190618','261976','1045562','881350','197784','211765','392454','244382','1370765','106251','1246586','1234333','1370760','1738590','208947','105398','203592','1738589','1007804','284702','1659445','1014366','1086950','1293834','1924604','1442844','1436947','1429379','1729511','211772','217626','466530','206294','206295','206352','220923','150945',
        '828364','206363','197779','309305','465711','211588','211594','310860','701983','1046688','206319','206369','206371','197785','103401','806527','206284','206365','1039923','1314932','1739871','1297950','220938','310870','581494','405240','1545670','1012238','206341','220750','1012354','1012569','1012309','543680','1116503','999597','206331','206334','206336','657561','199190','795067','846161','702424','1674200','220766','216237','7821','260312','206033','1189834','197781',
        '204106','206347','260311','1189206','1738594','208929','208918','604515','1362211','1235052','1360954','313786','830761','833505','833507','1090777','832711','849547','52147','1370763','1246588','792052','317564','1801282','1738596','1738586','998423','1540356','1115730','1095707','884077','1442848','2630845','1436949','1293727','2399659','2399654','2399661','545134','2590741','92265','206297','102250','216839','581875','211591','828362','94593','213320','211589','206317',
        '260318','211596','1293895','1291090','802059','1086614','1370767','476786','1012229','1012611','208680','105395','1424050','1542798','209245','206323','206324','206329','206332','206333','1370746','206373','761649','657429','1294266','1291383','759719','1491722','106948','352856','1013102','1037338','213528','351879','213525','1246538','1370772','1370758','206342','1294248','260192','1801281','197787','208816','1012244','1095708','1440936','2399644','2399656','1293943',
        '702503','404284','1370756','197780','1291103','211597','900420','206372','206296','211587','1234393','1234396','206286','1809843','1297952','1370752','352581','1013104','310898','1012312','103396','212221','1234519','866070','206330','206335','1310645','1545172','1043074','1294364','830788','904782','688704','197782','206338','310858','310889',
        '1012221','213527','545137','1012249','1246582','1370770','208712','261486','1116151','2630841','106963','1674197','1294246','1039281','545138','1250492','212077','2462510','1047761','1483223','206285','1291085','206396','310873','206320','219083','203990','543691','1250441','260306','284241','206030','204420','1250488','260305','208948','900409','1012226','804512','245818','1234317','106250','204077',
        '584468','1147069','313906','212567','1250461','1438754','283896','1370754','310899','1039273','206374','1291096','1291274','260308','1293731','1037340','902221','1291101','603955','1014367','797807','404285','1483218','206327','1370750','605649','1037330','206325','197786','1291292','545141','1012264','1012245','1370768','1294264','206281','2399650','2399652','211599','1294255','1233614','1250438','206322','404042','1650988','261044','105403','1311560','1357886','1357888','1358510','1358512','1358610','1358612','1358617','1358619','152369','1545704','1545705','1545706','1545707','1546236','1546237','155323','1743704',
        '1743707','1743720','1743722','1743726','1743729','1743779','1743781','1743855','1743856','1815','197969','197970','197971','197973','202702','203189','203856','203857','207136','207137','207138','207139','207141','207189','207190','207191','207192','207193','216466','216788','218293','218296','218297','218339','218340','218341','219343','22584','259966','260330','267396','311659','314099','328161','352759','352765','352766','352769','542400','544693','544700','544704','544779','6902','762675','834023','1005830','1005831','1007731','1011979','1011981','1011985','1011987','1012015','1012017','1012021','1012023','1012025','1012080','1012205','1012208','1012224','1013114','10169','102858','105403','105407',
        '1191678','1191686','1235042','1311560','1357886','1357888','1358510','1358512','1358610','1358612','1358617','1358619','1376336','139462','142438','152241','152369','1545704','1545705','1545706','1545707','1546236','1546237','1548705','1548714','1548724','1548739','1549315','1549317','155323','1596450','1743704','1743707','1743720','1743722','1743726','1743729','1743779','1743781','1743855','1743856','1815','1870193','19737','197969','197970','197971','197973','198142','202702','202844','202845','203189','203856','203857','205826','207136','207137','207138','207139','207141','207189','207190','207191','207192','207193','209002','209003','209004','209005','211751','211752','211753','211754','211755','214924',
        '215703','215968','216258','216464','216466','216788','216840','216841','217733','217734','217898','218285','218293','218296','218297','218339','218340','218341','218342','219136','219339','219341','219342','219343','219344','219345','219346','219347','219349','219351','219356','219403','220104','220126','22584','228476','228750','249066','259966','260125','260127','260285','260330','260391','260392','260394','260395','260396','260397','260398','260399','260400','260401','260402','260403','260409','261992','261993','267396','283077','284275','284516','285077','298665','310468','310469','311659','312610','312614','314099','314165','328161','343019','34372','345131','351519','351522','351704','352759','352765','352766','352769','352833','352834','352835','353629','47364',
        '541702','541705','542400','542614','542617','542618','542621','544693','544700','544704','544779','545250','547219','547222','55062','562379','57881','580011','604201','604204','643123','643125','643127','647127','662411','668658','668660','689325','690161','6902','702306','731217','731220','755702','755703','762675','792207','793099','794979','795094','795097','803308','808118','82101','824886','824889','834023','8638','91650
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']

- # Anticonvulsants
  quantity:
    anticonvulsants: "
      case when rxnorm_cui in (
        103911','151708','199378','200131','200133','2002','203029','203251','211353','211817','215879','308971','308972','308973','308974','308976',
        '308977','308979','313931','388311','402505','402506','404742','583135','672908','672909','672910','866303','866305','866307','105028','105029',
        '105030','1087976','1095695','1095698','1101333','1101335','1101337','1101338','1101339','1115012','1115013','1115015','1115016','142440','1482820',
        '1482821','1806380','1806382','196498','1992','2398511','2398512','25480','261280','261281','2634743','2634745','2634747','2634749','2634751','2634753',
        '283523','29787','310430','310431','310432','310433','310434','351973','476673','476677','476679','602396','602399','602405','602407','6387','6750',
        '8686','997846','997847','997850','187832','1988974','1988977','1988980','1994389','1994392','1994395','483438','483440','483442','483444','483446',
        '483448','483450','577127','593441','607018','607020','607022','607024','607026','607028','607033','607038','898715','898718','1099656','1099658',
        '1099670','1099672','1099681','1099683','1099687','1099689','1099691','1099693','11118','203245','804548','9919','14851','152332','199521','2047863',
        '2047868','250820','2642353','860895','860898','102298','103968','105018','105019','105033','10827','108782','1092357','1092360','1098608','1098610',
        '1099563','1099565','1099569','1099571','1099596','1099598','1099625','1099626','1099648','1099650','1099678','1099679','1099870','1099871','1112990',
        '1112993','1112994','1112997','1112999','1113001','1113003','1113005','1113007','1113009','11177','114477','1146690','1146692','1191051','1191056',
        '1191058','1191060','1193358','1193360','1193362','1299903','1299909','1299911','1299914','1299917','1299967','1299971','1299973','1299975','1299978',
        '1313112','1313884','1313885','1313887','134860','1356552','1356557','1356558','1356563','1356570','1356572','1356574','1356576','1356578','1356580',
        '1356582','1356584','1356586','1356588','1359010','1359011','1365653','1365655','1365660','1365842','1365844','1365847','1365850','1366192','1366196',
        '141953','1436239','1436240','1436245','1437278','1437280','1437283','1437285','1437288','1437290','1482501','1482502','1482507','1482508','1482513',
        '1482515','1482517','1482521','1482523','1482525','1482527','1494761','1494766','1494769','1494771','1494775','1494778','1494781','151226','151227',
        '151228','151229','151618','151699','151794','151879','152311','152408','152415','152855','153521','1605362','1605363','1605368','1605372','1605374',
        '1670195','1670197','1670200','1670201','1670351','1670352','1670353','1731015','1731020','1736037','1736038','1736044','1736045','1736047','1736048',
        '1736050','1736051','1736053','1739745','1739749','1739750','1739754','1739761','1739766','1739768','1739770','1739772','1739774','1739776','1739778',
        '1739780','1739782','1739785','1739788','1790122','1790126','1812419','1812421','1812425','1812427','1875866','1875868','1875870','1876012','1876014',
        '196502','197527','197528','197529','197682','197683','197923','197924','197925','197926','197949','198066','198150','198330','198358','198359','198427',
        '198428','198429','198430','199257','199450','199888','199889','199890','2001501','2001506','2001508','2003796','2003797','2003798','2003799','2003801',
        '201239','201240','201735','201737','201745','201747','201748','202366','202472','202474','202585','202587','202740','202981','203011','203128','203241',
        '204310','204319','204366','204433','204473','204511','2045371','205315','205316','2054968','2054973','2054974','2054979','2054981','2054983','2055011',
        '2055014','2055015','2055016','2057960','2058253','2058254','2058255','2058900','2058901','2058906','206157','206159','206160','206201','206749','206750',
        '206752','206753','206756','206758','207088','207342','207478','207496','208594','208595','209026','209027','209028','2102708','2102713','2102715','2102717',
        '211844','21241','216327','216458','216459','216460','216561','216586','216587','216609','216682','217243','2173494','2173495','2173500','218264','219107',
        '220343','221016','224900','225235','225874','2265690','2265695','2265696','2265701','2272614','2272621','2272622','2272623','2272624','2272627','2272630',
        '2272633','2272636','2283503','2283505','2283507','2283509','2283511','2283513','2283514','2283515','2283517','2283518','2283523','2283535','2283536','2283538',
        '2283539','2283540','236875','2381138','2381139','2381144','246172','2476636','2476640','24812','251322','252478','252479','2540431','2540432','258358','2585478',
        '2586427','2586428','2586433','2598','2606782','2606783','2606788','261335','261336','261356','261360','261547','261680','261708','262090','2637018','2637020',
        '2637025','2637027','2637030','2637032','2637035','266856','282401','283536','28439','284391','284408','284710','310285','311264','311265','311288','311289',
        '311290','312136','312137','312138','312627','314285','31914','32624','328176','32894','3322','33253','349010','349194','349195','349196','349197','349198',
        '351992','352891','380960','380990','380992','380998','38404','387003','392963','39998','403884','403966','403967','404530','404531','404532','404533','404545',
        '404595','404725','404726','405163','4135','4136','427538','4328','47858','542426','542687','542690','542691','542694','542733','542740','545223','623400','630807',
        '647121','647123','6757','6758','69036','6960','71227','72236','751139','751563','753451','755356','755357','795772','795774','795778','801957','801958','801961',
        '801962','801965','801966','807832','807834','809974','809979','809984','809987','809990','809992','809994','809996','809998','810000','810002','8183','82018',
        '824295','824296','824299','824301','824303','827207','82806','845478','845479','846378','847673','849049','849050','849051','849052','850087','850091','851748',
        '851749','851750','851751','851752','851753','855671','855673','855675','855677','855859','855861','855863','855869','855871','855873','855875','855889','855891',
        '855893','855895','855911','8691','881271','881272','900143','900145','900156','900157','900164','900165','900168','900169','900865','900866','900890','900891',
        '900983','900984','901323','901326','901328','901334','901336','92433','96304','993856','995156','999854
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']

- # Beta blockers
  quantity:
    beatablock: "
      case when rxnorm_cui in (
        104304','104305','104306','104308','104344','108744','1202','1202','1202','1202','1202','1202','1202','1202','1202','1202','1202','1202','150750',
        '151120','151195','151195','151195','151360','151360','151360','151360','151387','151387','151387','151387','151388','151388','151388','152409',
        '152409','152409','152413','152413','152413','152413','152414','152436','152436','152436','152436','152437','152437','152437','197379','197380',
        '197381','197382','197383','201218','201322','201323','201324','201325','201327','201328','201329','201330','201342','211773','219868','219868',
        '219868','219868','219868','2409','2409','2409','2409','2409','361007','361007','361007','361007','37789','37789','37789','746023','746030',
        '104313','1372709','151369','151435','151436','151991','1606347','1606349','1744259','1999031','1999033','1999035','1999037','200852','201331',
        '201332','201333','201334','201335','201336','203191','203344','2047761','2047766','2047769','2047772','2047775','214621','218072','221124',
        '361786','5487','6918','865575','866412','866414','866419','866421','866427','866429','866436','866438','866452','866455','866461','866464',
        '866472','866475','866479','866482','866491','866498','866502','866506','866508','866510','866511','866513','866514','866516','866924',
        '104293','104294','104295','1495058','1495059','1495064','151355','151367','151415','151426','151492','151890','152258','152259','200829',
        '200830','200831','200832','200833','200840','200841','200842','200843','200844','200846','200847','200848','200849','200850','214623',
        '27505','381209','541545','5487','82084','856393','856406','856417','856422','856423','856426','856429','856430','856433','856443',
        '856445','856448','856450','856457','856459','856460','856462','856468','856471','856481','856483','856508','856519','856521',
        '856528','856535','856537','856556','856557','856569','856571','856576','856578','856579','856583','856587','856588','856592',
        '856593','856597','856724','856733','856737','856739','8787
      )
      then 1 
      else 0
      end
    "
  metrics: ['sum']